# Default on_actions
on_monthly_pulse_country = {
    on_actions = {
        bic_breakup_check_on_action
        change_primary_culture_on_action
    }
}

on_half_yearly_pulse_country = {
    on_actions = {
        change_pop_culture_on_action
        migration_event_on_action
    }
}

on_secession_end = {
	effect = {
		if = {
			limit = {
				exists = c:ITA
				scope:target = {
					OR = {
						country_has_primary_culture = cu:north_italian
						country_has_primary_culture = cu:south_italian
					}
				}
			}
			c:ITA = { annex = scope:target }
		}
#		if = {
#			limit = {
#				exists = c:GER
#				scope:target = {
#					can_form_nation = GER
#				}
#			}
#			scope:target_country = {
#				THIS = c:GER
#				annex = scope:target
#			}
#		}
	}
}

# Called on_actions

bic_breakup_check_on_action = { #Also checks Dutch East Indies
	events = {
		bic_breakup.1
		vtm_dei_breakup.1
	}
}

change_primary_culture_on_action = {
    effect = {
        # Minor cultures en masse
        change_primary_culture_north_german_minor = {}
        change_primary_culture_south_german_minor = {}
        change_primary_culture_north_italian_minor = {}
        change_primary_culture_south_italian_minor = {}
    }
}

change_pop_culture_on_action = {
   effect = {
        # American minors
        # Afro-American
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = african_heritage"
            TOCULTURE = "afro_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
        }
        # Jewish-American
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = jewish_group"
            TOCULTURE = "jewish_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        # Hispanic-American
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = hispanophone"
            TOCULTURE = "hispano_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        # Luso-American
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = lusophone"
            TOCULTURE = "luso_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        # German-American - need to figure out how to merge 3 discriminated traits into one effect for this
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = german_speaking"
            TOCULTURE = "german_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = south_german_minor"
            TOCULTURE = "german_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = north_german_minor"
            TOCULTURE = "german_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        # French-American
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = french_minor"
            TOCULTURE = "franco_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = occitan_minor"
            TOCULTURE = "franco_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        # Irish-American
        change_pop_culture_culture = {
            FROMCULTURE = "irish"
            TOCULTURE = "irish_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        # Italian American
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = italophone"
            TOCULTURE = "italian_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = north_italian_minor"
            TOCULTURE = "italian_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = south_italian_minor"
            TOCULTURE = "italian_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }
        # Scottish American
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = caledonian"
            TOCULTURE = "scots_american"
            LIMIT = "country_has_primary_culture = cu:yankee"
            
        }

        # Canadian minors
        # Newfies
#        change_pop_culture_trait_state = {
#            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = anglophone"
#            TOCULTURE = "newfoundlander"
#            LIMIT = "THIS = s:STATE_NEWFOUNDLAND"
#        }
#        change_pop_culture_trait_state = {
#            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = celtic_people"
#            TOCULTURE = "newfoundlander"
#            LIMIT = "THIS = s:STATE_NEWFOUNDLAND"
#        }
        # Afro-Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = african_heritage"
            TOCULTURE = "afro_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # Scottish Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = caledonian"
            TOCULTURE = "scots_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # Anglo-Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = anglophone"
            TOCULTURE = "anglo_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # Irish-Canadian
        change_pop_culture_culture = {
            FROMCULTURE = "irish"
            TOCULTURE = "irish_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # Franco-Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = french_minor"
            TOCULTURE = "franco_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = occitan_minor"
            TOCULTURE = "franco_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # Greek Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = greek_culture"
            TOCULTURE = "greek_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # German Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = german_speaking"
            TOCULTURE = "german_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = north_german_minor"
            TOCULTURE = "german_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = south_german_minor"
            TOCULTURE = "german_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # Dutch Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = beneluxian_culture_group"
            TOCULTURE = "dutch_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }
        # Polish Canadian
        change_pop_culture_trait = {
            FROMCULTURE = "has_discrimination_trait = european_heritage has_discrimination_trait = west_slavic"
            TOCULTURE = "polish_canadian"
            LIMIT = "OR = { country_has_primary_culture = cu:anglo_canadian country_has_primary_culture = cu:franco_canadian }"
            
        }

        # Nationalism
        # North German
        change_pop_culture_technology = {
            TECHNOLOGY = "nationalism"
            FROMCULTURE = "has_discrimination_trait = north_german_minor"
            TOCULTURE = "north_german"
            OWNERCULTURES = "OR = { country_has_primary_culture = cu:north_german country_has_primary_culture = cu:south_german }"
        }
        # South German
        change_pop_culture_technology = {
            TECHNOLOGY = "nationalism"
            FROMCULTURE = "has_discrimination_trait = south_german_minor"
            TOCULTURE = "south_german"
            OWNERCULTURES = "OR = { country_has_primary_culture = cu:north_german country_has_primary_culture = cu:south_german }"
        }
        # North Italian
        change_pop_culture_technology = {
            TECHNOLOGY = "nationalism"
            FROMCULTURE = "has_discrimination_trait = north_italian_minor"
            TOCULTURE = "north_italian"
            OWNERCULTURES = "OR = { country_has_primary_culture = cu:north_italian country_has_primary_culture = cu:south_italian }"
        }
        # South Italian
        change_pop_culture_technology = {
            TECHNOLOGY = "nationalism"
            FROMCULTURE = "has_discrimination_trait = south_italian_minor"
            TOCULTURE = "south_italian"
            OWNERCULTURES = "OR = { country_has_primary_culture = cu:north_italian country_has_primary_culture = cu:south_italian }"
        }
        # French
        change_pop_culture_technology = {
            TECHNOLOGY = "nationalism"
            FROMCULTURE = "has_discrimination_trait = french_minor"
            TOCULTURE = "french"
            OWNERCULTURES = "OR = { country_has_primary_culture = cu:french country_has_primary_culture = cu:occitan }"
        }
        # Occitan
        change_pop_culture_technology = {
            TECHNOLOGY = "nationalism"
            FROMCULTURE = "has_discrimination_trait = occitan_minor"
            TOCULTURE = "occitan"
            OWNERCULTURES = "OR = { country_has_primary_culture = cu:french country_has_primary_culture = cu:occitan }"
        }

        # Pan-Nationalism
        # Yankee
        change_pop_culture_technology = {
            TECHNOLOGY = "pan-nationalism"
            FROMCULTURE = "has_discrimination_trait = american_minor"
            TOCULTURE = "yankee"
            OWNERCULTURES = "country_has_primary_culture = cu:yankee"
        }
        # Dixie
        change_pop_culture_technology = {
            TECHNOLOGY = "pan-nationalism"
            FROMCULTURE = "has_discrimination_trait = american_minor"
            TOCULTURE = "dixie"
            OWNERCULTURES = "country_has_primary_culture = cu:dixie"
        }
        # German
        change_pop_culture_technology = {
            TECHNOLOGY = "pan-nationalism"
            FROMCULTURE = "has_discrimination_trait = german_speaking"
            TOCULTURE = "yankee"
            OWNERCULTURES = "country_has_primary_culture = cu:german"
        }
        # Italian
        change_pop_culture_technology = {
            TECHNOLOGY = "pan-nationalism"
            FROMCULTURE = "has_discrimination_trait = italophone"
            TOCULTURE = "yankee"
            OWNERCULTURES = "country_has_primary_culture = cu:italian"
        }
    }
}

migration_event_on_action = {
    events = {
        border_migration.1
    }
}
